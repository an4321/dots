#!/bin/env bash

if [[ "$1" == "" ]]; then
    exec "$0" "$PWD"
else
    target_dir=$(zoxide query "$@")

    if [[ -d "$target_dir" ]]; then
        session_name="$(basename "$target_dir")"
        tmux new -ds "$session_name" -c "$target_dir" 2>/dev/null

        if [[ "$TMUX" == "" ]]; then
            tmux attach -t "$session_name"
        else
            tmux switch-client -t "$session_name"
        fi
    else
        echo "Error: Not a valid directory."
    fi
fi
