#!/usr/bin/env fish

test -z "$argv" && echo "usage: wiki <search term>" && return 1
set query (string join ' ' $argv)

set url "https://en.wikipedia.org/w/api.php?format=json&action=query&prop=extracts&exintro&explaintext&redirects=1&titles="
set response (curl -s -f "$url$query")
test $status -ne 0 && echo "error: curl failed" && return 1

set page (echo $response | jq -r ".query.pages[].extract")
test -z "$page" && return 1
echo $page | fold -s -w 80 | less
