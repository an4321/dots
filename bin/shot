#!/bin/env fish

set ss "$HOME/Pictures/screenshots/$(date +%F_%H-%M-%S).png"

switch $argv
	case "" "-s"
		if test -n "$WAYLAND_DISPLAY"
			slurp | xargs -r -I {} grim -g {} $ss
		else
			import "$ss"
		end
	case "-f"
		if test -n "$WAYLAND_DISPLAY"
			grim "$ss"
		else
			import -window root "$ss"
		end
end

if test -f $ss
	if test -n "$WAYLAND_DISPLAY"
		wl-copy < $ss
	else if type -q xsel
		xsel --clipboard --input --mime-type image/png < "$ss"
	end
	notify-send -i "$ss" "screenshot saved" "$ss"
end
