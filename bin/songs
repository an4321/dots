#!/bin/bash

playlist_url="https://www.youtube.com/playlist?list=PLjrw3vkjy7NahafX9q8GFGxhUYQqgMJXt"
ytdl_format="bestaudio"

while true; do
    video_id=$(youtube-dl --skip-download --get-id --flat-playlist "$playlist_url" | shuf -n 1)
    video_url="https://www.youtube.com/watch?v=$video_id"

    echo ""

    title=$(curl -s "$video_url" | grep -oP '<title>\K[^<]*')
    echo -e "\e[1;37mTitle:\e[0m \e[32m$title\e[0m"

    mpv --no-resume-playback --ytdl-format="$ytdl_format" --speed=1 "$video_url"

    read -s -n1 -t1 keypress 
    if [[ $keypress == $'q' ]]; then
        break
    fi
done
