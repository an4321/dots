#!/bin/env bash

menu() {
    fzf-tmux -m -e --preview-window=right:55% --preview "$@"
}

if command -v apt &> /dev/null; then
    [[ "$1" == "update" ]] && sudo apt update -y && exit
    [[ "$#" != 0 ]] && sudo apt install $@ && exit
    sel=$(apt-cache pkgnames | menu "apt-cache show {}")
    [ -n "$sel" ] && sudo apt install $sel

elif command -v pacman &> /dev/null; then
    [[ "$1" == "update" ]] && sudo pacman -Syu --noconfirm && exit
    [[ "$#" != 0 ]] && sudo pacman -S $@ && exit
    sel=$(pacman -Ssq | menu "pacman -Si {}")
    [ -n "$sel" ] && sudo pacman -S $sel

else
    echo "unsupported distribution: package manager not found" && exit 1
fi
