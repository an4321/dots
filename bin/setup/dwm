#!/bin/env fish
source "$HOME/dots/bin/helper/std.fish"

if checkcmd "apt"
    sudo apt install -y \
        make gcc libx11-dev libxft-dev libxinerama-dev xorg xsel psmisc libxrandr-dev \
        brightnessctl pamixer pavucontrol playerctl imagemagick libnotify-bin fonts-noto-color-emoji \
        copyq dunst feh nemo i3lock rofi arandr picom
	accept "install kitty" && eval "$(dirname (status -f))/kitty"
else if checkcmd "pacman"
    sudo pacman -S \
        make gcc xorg xorg-xinit base-devel libx11 libxft libxinerama xsel \
        brightnessctl pamixer pavucontrol playerctl imagemagick libnotify noto-fonts-emoji \
        copyq dunst feh nemo i3lock rofi arandr picom kitty
else
    die "unsupported distribution"
end

cd ~/.config/dwm
sudo make clean install && make clean

confirm "install nerd-fonts" && ~/dots/bin/install-nf

mkdir -p ~/Pictures/wallpapers
test -z "$(ls $HOME/Pictures/wallpapers)" && confirm "get a wallpaper?" \
	&& wget -O "$HOME/Pictures/wallpapers/$(uuidgen).png" "https://picsum.photos/1920/1080?random"

confirm "create dwm.desktop" && begin
	chmod +x ~/.xinitrc
	sudo touch /usr/share/xsessions/dwm.desktop
	echo -e "[Desktop Entry]\nEncoding=utf-8\nName=dwm\nExec=$HOME/.xinitrc\nIcon=dwm\nType=xsession" \
		| sudo tee /usr/share/xsessions/dwm.desktop
end
