set shell fish
set scrolloff 10
set ignorecase true
set previewer "~/.config/lf/preview"

map ga cd ~/Desktop
map gd cd ~/Downloads
map gD cd ~/Documents
map gp cd ~/Pictures
map gs cd ~/Pictures/screenshots
map gv cd ~/Videos
map gm cd ~/Music
map gn cd ~/notes
map g. cd ~/dots
map g, cd ~/.config
map gl cd ~/.local

# c: clear
# v: invert select
map J :push 5j
map K :push 5k
map . set hidden!
map x :cut
map <esc> clear
map <tab> !true
map ; :push &
map o :&xdg-open "$f"
map e $$EDITOR "$f"
map E $sudoedit "$f"
map i $fish
map I :& test -n "$TMUX" && tmux new-window || kitty
map t :& test -n "$TMUX" && tmux new-window -a -n lf 'lf' || kitty -e lf
map <a-a> !t "$PWD"

cmd jump ${{
	set result (jump list | fzf --height=100%)
	lf -remote "send $id cd '$result'"
}}
map z jump

cmd locate ${{
	set result $(fd . | fzf --height=100%)
	lf -remote "send $id select '$result'"
}}
map <c-f> locate

cmd trash %{{
	echo " Confirm (y/N): "
	read response
	if test "$response" = "y"
		for file in $fx
			trash "$file" || echo "ERROR: Failed to trash '$file'"
		end
		echo "done"
	else
		echo "exited"
	end
}}
map d trash
map <delete> trash
map D !trash-restore

cmd mk %{{
	echo " make: "
	read response
	if string match -r '/$' "$response"
		mkdir -p $response
		and lf -remote "send $id select '$response'"
	else if string match -r '\.$' "$response"
		set name (string replace -r '\.$' '' "$response")
		mkdir -p "$name" && lf -remote "send $id cd '$name'"
	else
		touch "$response" && lf -remote "send $id select '$response'"
	end
}}
map a mk

cmd on-redraw &{{
	if test "$lf_width" -le 100
		lf -remote "send $id set ratios 1:2"
	else
		lf -remote "send $id set ratios 1:2:3"
	end
}}
map R on-redraw
